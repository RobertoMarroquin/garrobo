{% extends 'base.html' %}
{% load humanize %} {% load static %} {% load crispy_forms_tags %}
{% block css %}
  <!--Select2 Filter CSS-->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />

{% endblock css %}
{% block content %}
<h5 class="text-center">{{libro.cliente.nombre}}</h5>
<h5 class="text-center">Retenciones Compras {{libro.get_mes_display}}/{{libro.ano}}</h5>
<hr>
<!------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------->

<div class="row">
    <div class="col-md-2">
        <a name="" id="" class="btn btn-primary" href="{% url 'iva:haciendacm' libro.id %}"
            role="button">Libros</a>
    </div>
    <div class="col-md-4"></div>
    <div class="col-md-2"></div>
    <div class="col-md-2"></div>
    <div class="col-md-2"><a name="" id="" class="btn btn-success" href="{% url 'iva:nueva_empresa2' libro.id %}"
        role="button">Nuevo Registro</a></div>
</div>
<br>
<!------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------->
<div class="container">
    <form action="" method="post">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-4">
                {{form.empresa|as_crispy_field}}
            </div>
            <div class="col-md-4">
                {{form.fecha|as_crispy_field}}
            </div>
            <div class="col-md-4">
                {{form.numeroDocumento|as_crispy_field}}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                {{form.numeroSerie|as_crispy_field}}
            </div>
            <div class="col-md-4">
                {{form.retencion|as_crispy_field}}
            </div>
            <div class="col-md-4">
                {{form.monto_sujeto|as_crispy_field}}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 text-center">
                <button type="submit" class="btn btn-primary">Guardar</button>
            </div>
        </div>
    </form>
</div>
<!------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------->
<div class="container">
    <div class="table-responsive">
        <table id="tabla1" class="table table-striped table-sm">
            <caption>Retenciones</caption>
            <thead class="thead-dark">
                <tr class="text-center">
                <th class="align-middle">Empresa</th>    
                <th class="align-middle">Fecha</th>
                <th class="align-middle">Numero de Documento</th>
                <th class="align-middle">Numero Serie</th>
                <th class="align-middle">Retencion</th>
                <th class="align-middle">Monto Sujeto</th>
            </tr>
            </thead>
            <tbody>
                {% for retencion in retenciones.all|dictsort:"fecha"  %}
                    <tr class="text-center">
                        <td class="align-middle">{{retencion.empresa}}</td>
                        <td class="align-middle">{{retencion.fecha}}</td>
                        <td class="align-middle">{{retencion.numeroDocumento}}</td>
                        <td class="align-middle">{{retencion.numeroSerie}}</td>
                        <td class="align-middle">{{retencion.retencion}}</td>
                        <td class="align-middle">{{retencion.monto_sujeto}}</td>
                    </tr>
                {% empty %}
                <tr class="text-center">
                    <td colspan=5 class="align-middle">No hay registros</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>



{% endblock content %}
{% block extrajs %}
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
<script>
    $(document).ready(function() {
        $("#id_empresa").select2();
        $('#id_empresa').show().focus().click();
    })
</script>
{% endblock extrajs %}